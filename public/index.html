<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>How to Avoid Addiction</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo" aria-hidden="true">üåü</div>
      <div>
        <h1>How to Avoid Addiction</h1>
        <p class="subtitle">Daily lessons + mini‚Äëgames to build healthy habits (no ads).</p>
      </div>
    </div>

    <nav class="tabs" aria-label="Main navigation">
      <button class="tab active" data-view="home">Home</button>
      <button class="tab" data-view="lesson">Today‚Äôs Lesson</button>
      <button class="tab" data-view="tracks">Tracks</button>
      <button class="tab" data-view="games">Mini‚ÄëGames</button>
      <button class="tab" data-view="habitquest">Habit Quest</button>
      <button class="tab" data-view="profile">Profile</button>
      <button class="tab" data-view="shop">Badges</button>
      <button class="tab" data-view="rate">Rate</button>
      <button class="tab" data-view="about">About</button>
    </nav>
  </header>

  <main class="container">
    <!-- DASHBOARD (Home) -->
    <section class="view" id="view-home">
      <div class="grid homeGridCompact">
        <div class="card">
          <h3 id="rec-title">Recommended next lesson</h3>
          <p class="muted" id="rec-desc">Loading‚Ä¶</p>
          <div class="actions" style="margin-top:10px;">
            <button class="btn small primary" id="btn-go-recommended" type="button">Go</button>
            <button class="btn small" id="btn-start-review" type="button">Mistake Review</button>
          </div>
        </div>

        <div class="card">
          <h3>Quick Tip</h3>
          <p id="tip-text">Loading tip‚Ä¶</p>
          <div class="actions" style="margin-top:10px;">
            <button class="btn small" id="btn-new-tip">New tip</button>
          </div>
          <div class="divider"></div>
          <h3 style="margin-top:0;">Safety</h3>
          <p class="muted" style="margin-bottom:0;">
            If you ever feel unsafe, talk to a trusted adult (parent/guardian, teacher, coach).
          </p>
        </div>
      </div>

    </section>


    <!-- LESSON -->
    <section class="view hidden" id="view-lesson">
      <div class="card">
        <div class="lessonHeader">
          <h2 id="lesson-title">Today‚Äôs Lesson</h2>
          <span class="badge" id="lesson-day">Day 1</span>
        </div>

        <p class="muted" id="lesson-goal">Goal: ‚Ä¶</p>
        <div class="lessonBody" id="lesson-content"></div>

        <div class="divider"></div>

        <h3>Mini Quiz</h3>
        <p class="muted">Answer all questions correctly to finish the lesson.</p>
        <div id="quiz"></div>

        <div class="actions">
          <button class="btn" id="btn-prev-lesson">Previous</button>
          <button class="btn" id="btn-next-lesson">Next</button>
          <button class="btn" id="btn-review-mistakes" type="button">Review Mistakes</button>
          <button class="btn primary" id="btn-complete-lesson" type="button">
            Mark Lesson Complete
          </button>
        </div>

        <p class="muted" id="lesson-status"></p>
        <div class="divider"></div>

        <h3>Reflection (1 minute)</h3>
        <p class="muted" id="reflection-prompt">Loading‚Ä¶</p>

        <textarea id="reflection-input" class="textInput" rows="4" placeholder="Type your reflection here..."></textarea>

        <div class="actions" style="margin-top:10px;">
          <button class="btn small" id="btn-save-reflection" type="button">Save Reflection</button>
          <span class="muted" id="reflection-status" style="align-self:center;"></span>
        </div>

      </div>
    </section>

    <!-- TRACKS -->
    <section class="view hidden" id="view-tracks">
      <div class="card">
        <h2>Choose a Focus Track</h2>
        <p class="muted">Optional: pick a topic to focus your lessons. You can switch anytime.</p>

        <label class="muted" for="track-select">Focus track</label>
        <select id="track-select" class="select">
          <option value="general">General (recommended)</option>
          <option value="nicotine">Nicotine / Vaping</option>
          <option value="alcohol">Alcohol</option>
          <option value="gaming">Gaming / Screen habits</option>
          <option value="socialmedia">Social media / Scrolling</option>
          <option value="caffeine">Caffeine / Energy drinks</option>
        </select>

        <div class="divider"></div>

        <h3>What you‚Äôll see</h3>
        <p class="muted" id="track-preview"></p>

        <div class="actions">
          <button class="btn primary" id="btn-apply-track">Use this track</button>
          <button class="btn" id="btn-clear-track">Back to General</button>
        </div>
      </div>
    </section>

    <!-- GAMES -->
    <section class="view hidden" id="view-games">
      <div class="card">
        <h2>Mini‚ÄëGames üéÆ</h2>
        <p class="muted">
          These games practice real-life skills: saying no, handling stress, and choosing healthy options.
        </p>

        <!-- Full-width grid (no sidebar buttons) -->
        <div id="games-grid" class="grid"></div>
      </div>
    </section>

    <!-- HABIT QUEST (TAB) -->
    <section class="view hidden" id="view-habitquest">
      <div class="card hero">
        <h2>Habit Quest üìñ</h2>
        <p class="muted">
          A branching story where your choices shape the path.
          Practice saying no, handling pressure, and making strong decisions.
        </p>

        <div class="actions">
          <button class="btn primary" id="btn-hq-play">Continue Story</button>
          <button class="btn" id="btn-hq-new">New Run</button>
        </div>
      </div>

      <div class="card" style="margin-top:14px;">
        <h3>Your Progress</h3>
        <p class="muted">
          Current node: <code id="hq-current-node">hq_start</code><br/>
          Tokens: <strong id="hq-token-count">0</strong> ‚Ä¢
          Hearts: <strong id="hq-heart-count">3</strong>
        </p>
      </div>
    </section>


    <!-- STORY MAP (PHASE 3) -->
    <section class="view hidden" id="view-map">
      <div id="map-wrap"></div>
    </section>


    <!-- PROFILE -->
    <section class="view hidden" id="view-profile">
      <div class="card">

        <!-- Header -->
        <div class="profileHeader">
          <div class="profileIdentity">
            <div class="profileAvatar" aria-hidden="true">
              <span id="profile-avatar-emoji">üôÇ</span>
              <img id="profile-avatar-img" class="hidden" alt="Your avatar" />
            </div>

            <div class="profileNameBlock">
              <h2 id="profile-title" style="margin:0;">Profile</h2>


              <label class="muted" for="profile-name-input" style="display:block; margin-top:8px;">
                Name
              </label>

              <div class="profileNameRow">
                <input id="profile-name-input" class="textInput" type="text" maxlength="24" placeholder="Your name" />
                <button class="btn small" id="btn-save-name" type="button">Save</button>
              </div>

              <p class="muted" style="margin:8px 0 0;">This is shown on your profile.</p>
            </div>
          </div>

          <!-- ALL STATS LIVE HERE -->
          <div class="profileStats">
            <div class="statPill">
              <div class="muted">Total XP</div>
              <div class="statValue" id="profile-xp">0</div>
            </div>
            <div class="statPill">
              <div class="muted">Level</div>
              <div class="statValue" id="profile-level">1</div>
            </div>
            <div class="statPill">
              <div class="muted">Lessons</div>
              <div class="statValue" id="profile-lessons">0</div>
            </div>
            <div class="statPill">
              <div class="muted">High Score</div>
              <div class="statValue" id="profile-highscore">0</div>
            </div>
            <div class="statPill">
              <div class="muted">Streak</div>
              <div class="statValue" id="profile-streak">0</div>
            </div>
          </div>
        </div>

        <div class="divider"></div>

        <!-- Main content -->
        <div class="profileTwoCol">
          <!-- Left: Avatar -->
          <div class="card" style="margin:0;">
            <h3 style="margin-top:0;">Choose an Avatar</h3>
            <p class="muted">Pick an emoji or upload your own photo.</p>
            <div id="avatar-grid" class="chips"></div>
          </div>

          <!-- Right: Badges (moved here) -->
          <div class="card" style="margin:0;">
            <h3 style="margin-top:0;">Your Badges</h3>
            <div id="owned-badges" class="chips"></div>
            <p class="muted" id="owned-badges-empty"></p>
          </div>
        </div>

        <div class="divider"></div>

        <!-- Single Progress section (ONLY ONCE) -->
        <div class="card" style="margin:0;">
          <div style="display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap;">
            <h3 style="margin:0;">Progress üìà</h3>
            <button class="btn small danger" id="btn-reset" type="button">Reset Progress (this device)</button>
          </div>

          <div class="divider"></div>

          <h3 style="margin:0;">Completed Days</h3>
          <div id="completed-list" class="chips" style="margin-top:10px;"></div>
        </div>

      </div>
    </section>


    <!-- SHOP -->
    <section class="view hidden" id="view-shop">
      <div class="card">
        <h2>Badges üèÖ</h2>
        <p class="muted">Badges unlock when you reach the XP requirement.</p>
        <div id="shop-grid" class="grid"></div>
      </div>
    </section>

    <!-- RATE -->
    <section class="view hidden" id="view-rate">
      <div class="card">
        <h2>Rate this app ‚≠ê</h2>
        <p class="muted">Tap a star to leave a rating (no popups).</p>

        <div class="stars" id="stars">
          <button class="star" data-star="1" aria-label="Rate 1 star">‚òÖ</button>
          <button class="star" data-star="2" aria-label="Rate 2 stars">‚òÖ</button>
          <button class="star" data-star="3" aria-label="Rate 3 stars">‚òÖ</button>
          <button class="star" data-star="4" aria-label="Rate 4 stars">‚òÖ</button>
          <button class="star" data-star="5" aria-label="Rate 5 stars">‚òÖ</button>
        </div>

        <p class="big" id="rating-average">‚Äî</p>
        <p class="muted" id="rating-count">No ratings yet</p>
        <p class="muted" id="rating-thanks"></p>
      </div>
    </section>

    <!-- ABOUT -->
    <section class="view hidden" id="view-about">
      <div class="card">
        <h2>About</h2>
        <p>
          <strong>How to Avoid Addiction</strong> is a free, kid‚Äëfriendly education app with daily lessons and mini‚Äëgames.
          No ads. No paywalls.
        </p>

        <h3>Donations (Optional)</h3>
        <p class="muted">
          In a future version, you can add a donation button that supports addiction prevention efforts.
          (We‚Äôll keep it safe + parent‚Äëfriendly.)
        </p>

        <h3>Credits</h3>
        <ul class="muted">
          <li>Built with HTML/CSS/JavaScript</li>
          <li>Hosted on Cloudflare (planned)</li>
          <li>Version control on GitHub</li>
        </ul>
      </div>
    </section>
  </main>

  <footer class="footer">
    <span>Created by Odin Garrett ‚Ä¢ ¬© <span id="year"></span> How to Avoid Addiction</span>
    <span class="dot">‚Ä¢</span>
    <button class="link" id="btn-open-lesson">Open Today‚Äôs Lesson</button>
    <span class="dot">‚Ä¢</span>
    <button class="link" id="btn-open-rate">Rate this app</button>
  </footer>

  <script src="curriculum.js"></script>
  <script src="app.js"></script>
</body>
</html>
